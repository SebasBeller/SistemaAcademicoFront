<head>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">

</head>
<div [ngClass]="getColorClass()">
  
  <div class="search-section">
    <label>Buscar por Nombre: </label>
    <input [(ngModel)]="filtroNombre" name="filtroNombre" placeholder="Nombre">
    <label>Buscar por Apellido:</label>
    <input [(ngModel)]="filtroapellido" name="filtroapellido" placeholder="Apellido">
  </div>

<div class="container">
  <button class="add-button" (click)="abrirFormulario()">
    <span>+</span> <b>Agregar Estudiante</b>
  </button>

        <!-- Modal para agregar/editar estudiante -->
        <div class="modal" *ngIf="mostrarFormulario">
            <div class="modal-content">
              <span class="close" (click)="cerrarFormulario()">&times;</span>
              <h2><b>{{ editando ? 'Editar Estudiante' : 'Agregar Estudiante' }}</b></h2>
        
              <form (ngSubmit)="guardarEstudiante()">
                  <label>Nombre:</label>
                  <input 
                  [(ngModel)]="estudiante.nombre" 
                  name="nombre" 
                  required 
                  maxlength="50" 
                  pattern="^[a-zA-ZáéíóúÁÉÍÓÚñÑ\s]+$"
                  #nombreInput="ngModel"
                  (ngModelChange)="generarEmailYPassword()" />
                  
                <div *ngIf="nombreInput.invalid && (nombreInput.dirty || nombreInput.touched)">
                  <small *ngIf="nombreInput.errors?.['required']"  class="error-text">El nombre es obligatorio.</small>
                  <small *ngIf="nombreInput.errors?.['maxlength']"  class="error-text">Máximo 50 caracteres.</small>
                  <small *ngIf="nombreInput.errors?.['pattern']"  class="error-text" >Solo letras permitidas.</small>
                </div>
              
          
                  <label>Apellido:</label>
                  <input [(ngModel)]="estudiante.apellido" name="apellido" required (ngModelChange)="generarEmailYPassword()" 
                  [(ngModel)]="estudiante.apellido" 
                  name="apellido" 
                  required 
                  maxlength="50" 
                  pattern="^[a-zA-ZáéíóúÁÉÍÓÚñÑ\s]+$"
                  #ApellidoInput="ngModel"
                  (ngModelChange)="generarEmailYPassword()" />
                  <div *ngIf="ApellidoInput.invalid && (ApellidoInput.dirty || ApellidoInput.touched)">
                    <small *ngIf="ApellidoInput.errors?.['required']" class="error-text">El apellido es obligatorio.</small>
                    <small *ngIf="ApellidoInput.errors?.['maxlength']" class="error-text">Máximo 50 caracteres.</small>
                    <small *ngIf="ApellidoInput.errors?.['pattern']" class="error-text">Solo letras permitidas.</small>
                  </div>
           
                <label>Email:</label>
                <input [(ngModel)]="estudiante.email" name="email" required />
        
                <label>Password:</label>
                <div class="password-container">
                  <input [(ngModel)]="estudiante.password" name="password" [type]="passwordVisible ? 'text' : 'password'" required />
  
                  <!-- Icono de ojo  -->
                  <i class="fa" [class.fa-eye]="!passwordVisible" [class.fa-eye-slash]="passwordVisible" (click)="togglePasswordVisibility()"></i>
                </div>
                
                <div>
                  <label >Paralelo: </label>
                  <select  (click)="actualizarParalelo($event)">
                    <option *ngFor="let paralelo of paralelos" [ngValue]="paralelo">
                      {{ paralelo.paralelo }}
                    </option>
                  </select>
                </div>
                

        
                <button type="submit">{{ editando ? 'Guardar Cambios' : 'Agregar' }}</button>
              </form>
            </div>
          </div>
  
  <table class="table">
    <thead>
      <tr>
        <th>Nombre</th>
        <th>Apellido</th>
        <th>Email</th>
        <th>Paralelo</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let estudiante of estudiantesFiltrados">
        <td>{{ estudiante.nombre }}</td>
        <td>{{ estudiante.apellido }}</td>
        <td>{{ estudiante.email }}</td>
        <td>{{ estudiante.paralelo?.paralelo }}</td>
        <td>
          <button (click)="editarEstudiante(estudiante.id_estudiante)">Editar</button>
        </td>
      </tr>
    </tbody>
  </table>
</div>

</div>